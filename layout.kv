#:import utils kivy.utils
BoxLayout:
    canvas:
        Color:
            rgba: .1, .1, .1, 1

        Rectangle:
            size: self.size
            pos: self.pos
    orientation: 'vertical'
    HeadingLabel:
        text: 'WhatsappAuto'

    StackLayout:
        # Button is a subclass of Label and can be sized
        # to text in the same way

        Button:
            text: 'Abrir arquivo'
            on_release: app.show_load()


        Button:
            text: 'Parar envio'
            on_release: app.parar()

        Button:
            text: 'Testa Telefones na Base de dados'
            on_release: app.cria_iter_importados()

        Button:
            text: 'Testa sem whats'
            on_release: app.cria_iter_sem()

        Button:
            text: 'Abre Web Whats'
            on_release: app.chama()

        Spinner:
            text: 'Headless'
            values: 'Ativar', 'Desativar'
            on_text: app.spinner_headless(self.text)

        Button:
            text: 'vCARD'
            on_release: app.clientes_com_whats_vcard()

        Button:
            text: 'Exibir Clientes'
            on_release: app.exibir()

    GridLayout:
        id: grid_layout
        cols: 2
        height: cm(7)
        width: cm(10)
        size_hint_y: None

        HeadingLabel:
            text: "Digite o texto a ser enviado"

        HeadingLabel:
            text: 'Execução'

        TextInput:
            id: left_content
            disabled_color: 0, 0, 0, 0
            on_text: app.set_atalho()
            focus: True

        ScrollView:
            do_scroll_x: False
            do_scroll_y: True

            Label1:
                id: right_content
                text_size: self.size
                padding: dp(6), dp(6)
                halign: 'center'
                valign: 'center'

    BoxLayout:
        canvas:
            Color:
                rgba: .1, .1, .1, 1

            Rectangle:
                size: self.size
                pos: self.pos
        orientation: 'horizontal'
        size_hint_y: .12
        Button:
            text: 'Salvar Mensagem'
            on_release: app.salva_mensagem()

        Spinner:
            text: 'Mensagem'
            values: 'Vencimento', 'Margem', 'Vencidos', 'Leilao', 'msg2'
            on_text: app.spinner_mensagem(self.text)

        Button:
            text: 'Limpar'
            on_release: app.limpar()

        Button:
            text: 'Selecionar Tudo'
            on_release: app.selecionar()
        Label:

        Button:
            text: 'Enviar Filtrados'
            on_release: app.enviar_vencimento()

        Button:
            text: 'Filtrar hoje'
            on_release: app.filtra_hoje()

        Button:
            text: 'Filtrar vencidos'
            on_release: app.filtra_vencidos()

        Button:
            text: 'Filtrar Margem'
            on_release: app.filtra_margem()
        Button:
            text: 'Filtrar Licitação'
            on_release: app.filtra_licitacao()
        TextInput:
            id: conteudo_licitacao
            disabled_color: 0, 0, 0, 0
            multiline: False
            on_text_validate: app.filtra_licitacao()
            on_focus: root.ids.right_content.text: 'Digite uma data para filtrar os contratos'
            input_type: 'datetime'
        Label:
            text: 'Pesquisar'

        TextInput:
            id: middle_content
            disabled_color: 0, 0, 0, 0
            multiline: False
            on_text_validate: app.filtra_data()
            on_focus: root.ids.right_content.text: 'Digite uma data para filtrar os contratos'
            input_type: 'datetime'


    # Need one Widget without size_hint_y: None, so that BoxLayout fills
    # available space.

    RVContratos1:
        # data: clientes_importados


    ProgBar:
        id: progbar
        pos_hint: {'x':.05}
        size_hint_x: .8
        size_hint_y: .1

# The column heading labels have their width set by the parent,
# but determine their height from the text.
<HeadingLabel@Label>:
    bold: True
    padding: dp(10), dp(4)
    valign: 'bottom'
    height: self.texture_size[1]
    text_size: self.width, None
    size_hint_y: None

<ToggleButton,Button>:
    padding: dp(20), dp(8)
    size_hint: None, None
    size: self.texture_size

# This inherits Button and the modifications above, so reset size
<Spinner>:
    size: sp(100), self.texture_size[1]

<Label1@Label>:
    # halign: app.halign
    # valign: app.valign


    canvas:
        Color:
            rgb: 68/255.0, 164/255.0, 201/255.0
        Line:
            rectangle: self.x, self.y, self.width, self.height

<StackLayout>:
    size_hint_y: None
    spacing: dp(0)
    padding: dp(0), dp(4)
    height: self.minimum_height

<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserIconView:
            id: filechooser

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)

<Row>:
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#0270af') if self.selected else (0.2, 0.2, 0.2, 1)
        Rectangle:
            size: self.size
            pos: self.pos
<Row1>:
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#0270af') if self.selected else (0.2, 0.2, 0.2, 1)
        Rectangle:
            size: self.size
            pos: self.pos
<Row2>:
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#0270af') if self.selected else (0.2, 0.2, 0.2, 1)
        Rectangle:
            size: self.size
            pos: self.pos
<RV>:
    canvas:
        Color:
            rgba: 0.1, 0.1, 0.1, 1
        Rectangle:
            size: self.size
            pos: self.pos
    rv: rv
    orientation: 'vertical'
    GridLayout:
        cols: 3
        rows: 2
        size_hint_y: None
        height: dp(108)
        padding: dp(8)
        spacing: dp(16)
        Button:
            text: 'Listar Clientes'
            on_press: root.populate()
        BoxLayout:
            Button:
                text: 'Listar Contratos'
                on_release: root.populate_contratos()
            Spinner:
                text: 'Ordenado por'
                values: 'Avaliação', 'Empréstimo', 'Contrato', 'Vencimento'
                on_text: root.spinner_ordenado(self.text)
            Spinner:
                text: '/\ \/'
                values: 'Ascendente', 'Descendente'
                on_text: root.spinner_asc_desc(self.text)
        BoxLayout:
            Button:
                text: 'Mostrar telefones'
                on_press: root.exibir()
            Button:
                text: 'Mostrar Contratos'
                on_press: root.exibir_contratos()
        Button:
            text: 'Ordenar por Nome'
            on_press: root.sort()
        BoxLayout:
            Button:
                text: 'Inserir Cliente'
                on_press: root.insert(new_item_input.text, new_item_input_2.text)
            BoxLayout:
                spacing: dp(8)

                TextInput:
                    id: new_item_input
                    size_hint_x: 0.6
                    hint_text: 'Nome'
                    padding: dp(10), dp(10), 0, 0
                    multiline: False
                TextInput:
                    id: new_item_input_2
                    size_hint_x: 0.6
                    hint_text: 'CPF'
                    padding: dp(10), dp(10), 0, 0
                    multiline: False
        BoxLayout:
            spacing: dp(10)
            Button:
                text: 'Pesquisa'
                on_press: root.search(update_item_input.text)
            TextInput:
                id: update_item_input
                size_hint_x: 0.6
                hint_text: 'Pesquisa'
                padding: dp(10), dp(10), 0, 0
                multiline: False
                on_text_validate: root.search(self.text)
            Button:
                text: 'Remove item'
                on_press: root.remove()

    RecycleView:
        id: rv
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        # bar_width: dp(10)
        viewclass: 'Row'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            halign: 'left'
            valign: 'left'
            # pos_hint: {'x': 0.0, 'y': 0.5}
            # multiselect: True
            # touch_multiselect: True

<RVIncluirContrato>:
    canvas:
        Color:
            rgba: 0.3, 0.3, 0.3, 1
        Rectangle:
            size: self.size
            pos: self.pos
    # rv_incluir_contrato: rv_incluir_contrato
    orientation: 'vertical'

    BoxLayout:
        # cols: 1
        # rows: 4
        # size_hint_y: .8
        # height: dp(50)
        # padding: dp(8)
        # spacing: dp(16)
        orientation: 'vertical'

        BoxLayout:
            # padding: dp(15)
            size_hint_y: None
            height: dp(40)
            spacing: dp(8)
            Button:
                text: 'Listar Contratos'
                on_press: root.populate()
            Button:
                text: 'Inserir Contrato'
                on_release: root.insert(numero.text, avaliacao.text, emprestimo.text, vencimento.text, prazo.text, limite.text)
            Button:
                text: 'Remove Contrato'
                on_press: root.remove()
        BoxLayout:
            # padding: dp(15)
            size_hint_y: None
            height: dp(40)
            spacing: dp(8)

            TextInput:
                padding: dp(15)
                id: numero
                size_hint_x: .4
                hint_text: 'Número do Contrato'
                padding: dp(10), dp(10), 0, 0
                multiline: False
                # on_text_validate: root.insert(self.text)
            TextInput:
                padding: dp(15)
                id: valor_avaliacao
                size_hint_x: .3
                hint_text: 'Valor Avaliação'
                padding: dp(10), dp(10), 0, 0
                multiline: False
                # on_text_validate: root.insert(self.text)
            TextInput:
                id: valor_emprestimo
                size_hint_x: .3
                hint_text: 'Valor Empréstimo'
                padding: dp(10), dp(10), 0, 0
                multiline: False


        BoxLayout:
            # padding: dp(15)
            size_hint_y: None
            height: dp(40)
            spacing: dp(8)

            TextInput:
                id: vencimento
                size_hint_x: .4
                hint_text: 'Vencimento'
                padding: dp(10), dp(10), 0, 0
                multiline: False
            TextInput:
                id: prazo
                size_hint_x: .2
                hint_text: 'Prazo'
                padding: dp(10), dp(10), 0, 0
                multiline: False
            TextInput:
                id: limite
                size_hint_x: 0.2
                hint_text: 'Limite 100% ou 85%'
                padding: dp(10), dp(10), 0, 0
                multiline: False
            Label:
                size_hint_x:.4



    RecycleView:
        id: rv_incluir_contrato
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        bar_width: dp(20)
        viewclass: 'Row1'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'


<RVTelefones>:
    canvas:
        Color:
            rgba: 0.3, 0.3, 0.3, 1
        Rectangle:
            size: self.size
            pos: self.pos
    rv_telefone: rv_telefone
    orientation: 'vertical'

    GridLayout:
        cols: 4
        rows: 1
        size_hint_y: None
        height: dp(50)
        padding: dp(8)
        spacing: dp(16)


        BoxLayout:
            spacing: dp(8)
            Button:
                text: 'Listar Telefones'
                on_press: root.populate()
            Button:
                text: 'Inserir Telefone'
                on_press: root.insert(novo_telefone.text)
            TextInput:
                id: novo_telefone
                size_hint_x: 0.6
                hint_text: 'telefone'
                padding: dp(10), dp(10), 0, 0
                multiline: False
                on_text_validate: root.insert(self.text)

        Button:
            text: 'Remove telefone'
            on_press: root.remove()

    RecycleView:
        id: rv_telefone
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        # bar_width: dp(10)
        viewclass: 'Row1'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'

<RVTelefonesEnviar>:
    canvas:
        Color:
            rgba: 0.3, 0.3, 0.3, 1
        Rectangle:
            size: self.size
            pos: self.pos
    rv_telefone: rv_telefone
    orientation: 'vertical'

    GridLayout:
        cols: 4
        rows: 1
        size_hint_y: None
        height: dp(50)
        padding: dp(8)
        spacing: dp(16)


        BoxLayout:
            spacing: dp(8)
            Button:
                text: 'Enviar'
                on_release: root.enviar_mensagem()


    RecycleView:
        id: rv_telefone
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        # bar_width: dp(10)
        viewclass: 'Row1'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'

<RVContratos>:
    canvas:
        Color:
            rgba: 0.0, 0.0, 0.0, 0
        Rectangle:
            size: self.size
            pos: self.pos
    rv_contratos: rv_contratos
    orientation: 'vertical'

    GridLayout:
        cols: 5
        rows: 1
        size_hint_y: None
        height: dp(50)
        padding: dp(8)
        spacing: dp(16)

        BoxLayout:
            # orientation: 'horizontal'
            spacing: dp(8)
            Button:
                text: "Incluir"
                on_release: root.incluir_contrato()
            Label:
                text: "Número"
            Label:
                text: "Avaliação"
            Label:
                text: 'Empréstimo'
            Label:
                text: 'Vencimento'


    RecycleView:
        id: rv_contratos
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        # bar_width: dp(10)
        viewclass: 'Row2'
        SelectableRecycleBoxLayout:
            default_size: None, dp(56)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'
            pos_hint: {'x': 0.0, 'y': 0.5}
            multiselect: True
            touch_multiselect: True
    GridLayout:
        cols:5
        rows:1
        size_hint_y: None
        height: dp(50)
        padding: dp(8)
        spacing: dp(16)
        Button:
            text: 'Calcular Juros Todos'
            on_press: root.calcular()
        Button:
            text: 'Calcular Selecionados'
            on_press: root.calcular1()
        Button:
            text: 'Calcular Margem'
            on_press: root.calcular_margem()
        TextInput:
            id: 'data_futura'
            hint_text: 'Data de pagamento'
            multiline: False
            size_hint_y: 0.2
            on_text_validate: root.calcular2(self.text)
        Button:
            text: 'Calcular Liquidação'
            on_press: root.calcular_liquidacao()
        Label:
        Label:

<RVContratos1>:
    canvas:
        Color:
            rgba: 0, 0, 0, 0
        Rectangle:
            size: self.size
            pos: self.pos
    rv_bottom: rv_bottom
    orientation: 'vertical'

    GridLayout:
        cols: 1
        rows: 1
        size_hint_y: None
        height: dp(50)
        padding: dp(8)
        spacing: dp(16)

        BoxLayout:
            spacing: dp(8)
            Button:
                text: 'Exibir'
                on_press: root.populate()
            Label:
                text: "Nome"
            Label:
                text: "CPF"
            Label:
                text: 'Vencimento'
            Label:
                text: 'Telefones'


    RecycleView:
        id: rv_bottom
        scroll_type: ['content']
        scroll_wheel_distance: dp(114)
        # bar_width: dp(10)
        # size_hint: 1.
        viewclass: 'Row3'
        RecycleBoxLayout:
            default_size: None, dp(30)
            default_size_hint: 1, None
            size_hint_y: None
            height: self.minimum_height
            orientation: 'vertical'


<RVCalculo>:
    canvas:
        Color:
            rgba: 0, 0, 0, 0
        Rectangle:
            size: self.size
            pos: self.pos
    rv_calculo: rv_calculo
    orientation: 'vertical'

    BoxLayout:
        orientation: 'vertical'
        GridLayout:
            cols: 1
            rows: 1
            height: dp(50)
            padding: dp(8)
            spacing: dp(16)
            size_hint_y: None

            BoxLayout:
                spacing: dp(8)
                Label:
                    text: "Prazo"
                Label:
                    text: "Valor"
                Label:
                    text: 'Vencimento'


        RecycleView:
            id: rv_calculo
            scroll_type: ['content']
            scroll_wheel_distance: dp(114)
            # bar_width: dp(10)
            height: 100
            size_hint_y: .8
            viewclass: 'Row4'
            RecycleBoxLayout:
                default_size: None, dp(35)
                default_size_hint: 1, None
                height: self.minimum_height
                size_hint_y: None
                orientation: 'vertical'
        GridLayout:
            cols:2
            rows:1
            size_hint_y: None
            padding: dp(10)
            spacing: dp(20)
            Button:
                text: 'Enviar para cliente'
                on_release: root.enviar_cliente()
            Label:
                valign: 'bottom'
                halign: 'center'
                id: calculo
                text_size: self.size

<RVCalculoLiquidacao>:
    canvas:
        Color:
            rgba: 0, 0, 0, 0
        Rectangle:
            size: self.size
            pos: self.pos
    rv_calculo_liquidacao: rv_calculo_liquidacao
    orientation: 'vertical'

    BoxLayout:
        orientation: 'vertical'
        GridLayout:
            cols: 1
            rows: 1
            height: dp(50)
            padding: dp(8)
            spacing: dp(16)
            size_hint_y: None

            BoxLayout:
                spacing: dp(8)
                Label:
                    text: "Contrato"
                Label:
                    text: "Valor"
                Label:
                    text: 'Encargos/Desconto'



        RecycleView:
            id: rv_calculo_liquidacao
            scroll_type: ['content']
            scroll_wheel_distance: dp(114)
            # bar_width: dp(10)
            height: 100
            size_hint_y: .8
            viewclass: 'Row5'
            RecycleBoxLayout:
                default_size: None, dp(35)
                default_size_hint: 1, None
                height: self.minimum_height
                size_hint_y: None
                orientation: 'vertical'
        GridLayout:
            cols:3
            rows:1
            size_hint_y: None
            padding: dp(10)
            spacing: dp(20)
            Button:
                text: 'Enviar para cliente'
                on_release: root.enviar_cliente()
            Label:
                valign: 'bottom'
                halign: 'center'
                id: calculo_liquidacao
                text_size: self.size
            Label:
                id: valor_total

# <Row2@RecycleKVIDsDataViewBehavior+BoxLayout>:
#     # canvas.before:
#     #     Color:
#     #         rgba: 0.3, 0.3, 0.3, 1
#     #     Rectangle:
#     #         size: self.size
#     #         pos: self.pos
#     value: ''
#     Label:
#         id: contrato
#     Label:
#         id: avaliacao
#     Label:
#         id: emprestimo
#     Label:
#         id: vencimento


<Row3@RecycleKVIDsDataViewBehavior+BoxLayout>:
    canvas.before:
        Color:
            rgba: 0.2, 0.2, 0.2, 1
        Rectangle:
            size: self.size
            pos: self.pos

    Label:
        id: nome
    Label:
        id: cpf
    Label:
        id: vencimento
    Label:
        id: telefones

<Row4@RecycleKVIDsDataViewBehavior+BoxLayout>
    canvas.before:
        Color:
            rgba: 0.2, 0.1, 0.1, .05
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        id: prazo
    Label:
        id: valor
    Label:
        id: vencimento


<Row5@RecycleKVIDsDataViewBehavior+BoxLayout>
    canvas.before:
        Color:
            rgba: 0.2, 0.1, 0.1, .05
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        id: contrato
    Label:
        id: valor
    Label:
        id: encargos